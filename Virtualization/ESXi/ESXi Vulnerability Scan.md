# ESXi Vulnerability Scan

Once I had my VMWare ESXi server running, I wanted to run a vulnerability scan prior to creating any VMs. To do this, I will be using Tenable. At the time of the ESXi install, the version that was installed was version 7 update 2.

I first logged into Tenable and created a new scan. My ESXi server in on the 10.10.100.40 IP, here I entered the details of the host for the scan:

![Pasted image 20240422132916](https://github.com/lm3nitro/Projects/assets/55665256/b523fc14-3e12-4390-8b54-c79d495a6984)

I satarted the scan:

![Pasted image 20240422133341](https://github.com/lm3nitro/Projects/assets/55665256/897551fe-125e-4206-a8bf-082498ce6cbc)

Why the scan was running, I also had Wireshark running at the same time capturing the traffic. Here I was able to see reference to the CVE within the traffic:

![Pasted image 20240422140944](https://github.com/lm3nitro/Projects/assets/55665256/8957f0c1-9f36-424c-8356-63f28e2925ef)

Once the scan completed, this is an overview of what it was able to find:

![Pasted image 20240422135211](https://github.com/lm3nitro/Projects/assets/55665256/37a27903-db10-4770-ab9f-89d8b3792ba6)

Lets expand and take a closer look into the what it was able to find on our ESXi server. According to the scan, I have a Critical vulnerability, 2 High, and 2 Medium:

![Pasted image 20240422135426](https://github.com/lm3nitro/Projects/assets/55665256/2d11730a-9271-408f-882a-5acfd126291a)

Lets take a closer look at the Critical vulnerability since that is obviously the most conerning. We can also see that it provides us with information on how we can remediate the vulnerability. In this case, this CVE is remediated by apply the patch update 3 for version 7:

![Pasted image 20240422135542](https://github.com/lm3nitro/Projects/assets/55665256/30bc8836-2665-42c3-aef7-fc931b8610b9)

I also went to the NVD page to locate the CVE and get more information. I can see that this CVE was recently published:
![Pasted image 20240422140023](https://github.com/lm3nitro/Projects/assets/55665256/0acf5876-9a20-49dc-a37e-0e0edebbfe29)

![Pasted image 20240422140133](https://github.com/lm3nitro/Projects/assets/55665256/dc2b2f35-83dc-4aea-82f8-58af93d57815)

I also did the same for both High CVEs that were found:
![Pasted image 20240422135724](https://github.com/lm3nitro/Projects/assets/55665256/16587bc1-931d-41c9-acf6-a4f7af3d7a57)

![Pasted image 20240422135840](https://github.com/lm3nitro/Projects/assets/55665256/ca5e712d-3751-483e-895e-1462e7b44695)

Due to the severity of the vulnerabilities discovered, it was imperative to remediate the ESXi server promptly. The complete patching and remediation procedures are detailed separately under "Patching ESXi." After installing the latest patch, as mentioned earlier as a resolution (version 7 update 3), I conducted another vulnerability scan to verify full remediation and confirm that the patch adequately addressed all previously identified CVEs.


# Post Remediation ESXi Vulnerability Scan

During the scan, I was able to go to the ESXi server and monitor the traffic. Here we see some anomolies and a high volume that is espected due to the scan that we are performing:

![Pasted image 20240422141913](https://github.com/lm3nitro/Projects/assets/55665256/15dc49b0-3439-438a-bbfb-3aa832da72e5)

Once the scan completed, these were the results:

![Pasted image 20240422150130](https://github.com/lm3nitro/Projects/assets/55665256/7e6e359f-ec1e-43e0-a660-399ad4cbb68d)

The patch worked. As we can see, we no longer have any vulnerabilities. The Medium rated vulnerabilities are related to the certificate on the ESXi server: 

![Pasted image 20240422150211](https://github.com/lm3nitro/Projects/assets/55665256/d8d793f9-a11c-427d-bef7-60510db27cb2)

Here are the details of the Medium vulnerability related to the certificate:

![Pasted image 20240422150511](https://github.com/lm3nitro/Projects/assets/55665256/b3cc7b40-8751-43e9-8687-89b1b9465832)

I also navigated to the certificate itself and can see the following:

![Pasted image 20240422150422](https://github.com/lm3nitro/Projects/assets/55665256/76bb2a1a-3e1c-496a-89f4-78fdacec453e)

![Pasted image 20240422150539](https://github.com/lm3nitro/Projects/assets/55665256/d4e3ed86-bbbf-4a77-b289-70b02917b9f4)


The resilution for this is to have a proper SSL certificate. For the reasons I am using the ESXi server, this is not something that warrants immediate attention, but something that will be addressed later. 

