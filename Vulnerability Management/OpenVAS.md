# $${\color{green}OpenVAS}$$

![Pasted image 20240423141319](https://github.com/lm3nitro/Projects/assets/55665256/d3705acd-bd4d-4684-aab8-ab72d7c8a0d5)

OpenVAS is an open-source vulnerability scanner used to scan computer systems and networks. It helps identify weaknesses that could be exploited by the adversary while also providing detailed reports and recommendations. Its capabilities include unauthenticated and authenticated testing, various high-level and low-level internet and industrial protocols, and performance tuning for large-scale scans. 

### Scope: 

I will be installing OpenVAS and will be scanning a target host. I will also be monitoring on the web server with Wireshark to see the traffic generated by OpenVAS while scanning. I will also cover the findings of the report and the recommended remediation. 

### Tools and Technologies:
Linux OS, OpenVAS, Apache2 and Wireshark

## Installation

To get started I first need edto install Postgresql:

```
sudo apt install postgresql
```

![Pasted image 20240423133224](https://github.com/lm3nitro/Projects/assets/55665256/d159b274-a4b4-4e67-b0c3-2dd35efc012f)

Next, I needed to install the repository:

```
sudo add-apt-repository ppa:mrazavi/gvm
```

![Pasted image 20240423133255](https://github.com/lm3nitro/Projects/assets/55665256/07e806db-2348-4b94-84e7-53195f742d19)

Select *Yes*

![Pasted image 20240423150547](https://github.com/lm3nitro/Projects/assets/55665256/5eee0f7b-b41e-44a0-8365-44cd8dcf4f32)

![Pasted image 20240423150616](https://github.com/lm3nitro/Projects/assets/55665256/b98373f4-2e80-4725-8edc-7ab3024f3510)

Click on *Localhost* and then select *Ok*

![Pasted image 20240423150856](https://github.com/lm3nitro/Projects/assets/55665256/72080701-1db9-4d83-a98c-0fe972373a48)

Click on *Yes*

![Pasted image 20240423150927](https://github.com/lm3nitro/Projects/assets/55665256/9589adce-fb59-404f-aca8-fc6980dacd31)

I then needed to install GVM (OpenVAS):

```
sudo apt install gvm
```

![Pasted image 20240423133511](https://github.com/lm3nitro/Projects/assets/55665256/fd09e2e8-309f-4a7b-b690-a324f2476640)

Once that was installed, I created the notus directory:

```
sudo mkdir /var/lib/notus
sudo chown gvm:gvm /var/lib/notus
```

Last but not least, I needed to synchronize the greenbone nvt/cert/scap data. This will ensure everything is up to date:

1. Synchronize nvt

```
sudo -u gvm -g gvm greenbone-nvt-sync
```

![Pasted image 20240423133602](https://github.com/lm3nitro/Projects/assets/55665256/a8b22b8d-531e-430e-ab51-d46ea5c47f84)

2. Synchronize SCAP

```
sudo -u gvm -g gvm greenbone-feed-sync-legacy --type SCAP
```

![Pasted image 20240423134657](https://github.com/lm3nitro/Projects/assets/55665256/b1ab685f-12d1-4266-8c8b-992b12e1ab3b)

3. Synchronize GVMD_DATA

```
sudo -u gvm -g gvm greenbone-feed-sync-legacy --type GVMD_DATA
```

![Pasted image 20240423134554](https://github.com/lm3nitro/Projects/assets/55665256/fe4bd50a-16eb-4303-922b-960e1d726c08)

>#### Optional: If needed, removeNVT db can be removed and rebuilt.

```
export $(sudo cat /etc/default/gvmd-pg)
sudo -E -u gvm -g gvm gvmd --rebuild
```

## OpenVAS

To access the Greenbone Security Assistant web interface, I can use the following 

```
https://lm3nitro.openvas.vuln.local:9392
```

![Pasted image 20240423133944](https://github.com/lm3nitro/Projects/assets/55665256/2a5323b6-662f-44aa-a409-0ad70836f7e2)

By default, the username/password is as follows:

```
Username: admin
Password: admin
```

Upon logging in, I was presented with the dashboard:

![Pasted image 20240423134139](https://github.com/lm3nitro/Projects/assets/55665256/d3cef6a0-4936-4fc9-8729-26dbf19321a4)

To check the status of the feeds, go to *Administration --> Feed Status*

Go to Administration --> Feed Status and check the status of the feeds:

![Pasted image 20240423201952](https://github.com/lm3nitro/Projects/assets/55665256/f01df476-99c7-4552-8617-d963333851f0)

Systemctl can be used to check the status of the greenbone daemons. Below is a series of status checks:

Scanner:

```
systemctl status ospd-openvas 
```

![Pasted image 20240423134751](https://github.com/lm3nitro/Projects/assets/55665256/6bc84cd9-2b1f-4d4f-81b4-21652360483a)

Manager:

```
systemctl status gvmd 
```

![Pasted image 20240423134828](https://github.com/lm3nitro/Projects/assets/55665256/4dc35cad-64c3-4c8a-a64a-19ca2ffc10f7)

Web UI:

```
systemctl status gsad  
```

![Pasted image 20240423134937](https://github.com/lm3nitro/Projects/assets/55665256/c96d714a-97a9-4d18-95b9-9d4e18b80f30)

## Vulnerability Scan:

Once I had verified that everything was up and running, I ran a vulnerability scan against target VM:

![Pasted image 20240423202049](https://github.com/lm3nitro/Projects/assets/55665256/6ceab7cf-21a3-4abd-bc77-11bf49e387c6)

Adding the target IP:

![Pasted image 20240423173656](https://github.com/lm3nitro/Projects/assets/55665256/10869848-70c9-4e5d-ab1d-c90cac6183dd)

Scan is running:

![Pasted image 20240423174237](https://github.com/lm3nitro/Projects/assets/55665256/218125f8-5918-4b50-ad50-fd0716b4f7f3)

Service detection section: 

![Pasted image 20240423173455](https://github.com/lm3nitro/Projects/assets/55665256/5a37965a-b22d-49ba-89aa-ff20a5e24f95)

Detecting OpenVAS version with Wireshark. While the scan was running, I had Wireshark running and was able to detect the scan running:

![Pasted image 20240423173939](https://github.com/lm3nitro/Projects/assets/55665256/7bc7ee4f-5c63-46ad-a6ab-65a1a94b58ec)

Once the scan completed, these were the results:

![Pasted image 20240423180957](https://github.com/lm3nitro/Projects/assets/55665256/8fdf2918-6c07-4c3d-8202-2803ac3e2164)

Details on the report:

![Pasted image 20240423181048](https://github.com/lm3nitro/Projects/assets/55665256/bdf233b7-351b-44f1-8234-34cbf1b7a168)

I then narrowed down to the target to see all the application and services detected by scanner:

![Pasted image 20240423181206](https://github.com/lm3nitro/Projects/assets/55665256/734d6e9d-cb9d-4f80-9823-052c89029763)

When also looking at the vulernability scan in Wireshark, I saw taht it mentioned the use of Nikto. It seems like OpenVAS uses Nikto under the hood for web application vulnerability:

![Pasted image 20240423182022](https://github.com/lm3nitro/Projects/assets/55665256/d8462d38-3e51-414c-964a-1a74851dd7d2)

I then took a closer look at the critical vulnerabilities:

![Pasted image 20240423181303](https://github.com/lm3nitro/Projects/assets/55665256/4862f0a2-9e90-436d-8f9f-310ccbc4e386)

One of the vulnerabilities that caught my eye was the `Remote Code Execution`:

![Pasted image 20240423181406](https://github.com/lm3nitro/Projects/assets/55665256/d846c071-ad23-4ca5-988f-006698ac44cb)

Looking into this particular vulnerability, I was able to see information about the associated CVE, in this case, CVE-2004-2687. This is a very old vulenrability:

![Pasted image 20240423181507](https://github.com/lm3nitro/Projects/assets/55665256/10615e36-6c4f-4aa1-8af2-c3b68ae636ef)

I also looked at NVD for information about the CVE. The affected platforms are older and have since released newer versions. Updating should be able to esolve thei issue. 

![Pasted image 20240423181651](https://github.com/lm3nitro/Projects/assets/55665256/390c07d0-9ffe-4738-afda-83ae9ff605c1)

The scan also provided infomation about the target host itself:

![Pasted image 20240423182541](https://github.com/lm3nitro/Projects/assets/55665256/3f74b4ee-3b11-4102-8ac3-5f174174b56f)

One of the dectections it was able to find is that this OS is EOL and no longer supported:

![Pasted image 20240423181803](https://github.com/lm3nitro/Projects/assets/55665256/289a368c-bcbc-44d6-a3d4-01fd560423b5)

Going back to the scan results, it was also able to find another command execution vulnerability:

![Pasted image 20240423182345](https://github.com/lm3nitro/Projects/assets/55665256/ae77d481-dbbc-4c92-a4d2-16b9ba707daa)

Getting some extra information from NVD on CVE-2008-5304:

![Pasted image 20240423182256](https://github.com/lm3nitro/Projects/assets/55665256/c5677576-1903-4ed8-ad53-c5405233da85)

### Summary: 

In this exercise, I successfully installed and configured OpenVAS to perform a vulnerability scan on a target host, while using Wireshark to monitor and capture the network traffic generated during the scan. By doing so, I was able to gain hands-on experience in identifying security vulnerabilities and understanding the traffic patterns associated with vulnerability scans. The findings from OpenVAS highlighted critical vulnerabilities that could potentially be exploited by attackers, emphasizing the importance of proactive security assessments. This exercise underscored the value of regular vulnerability scanning, network monitoring, and the timely remediation of security issues to protect web servers and prevent cyberattacks.
In conclusion, as mitigation, it is recommended to update the target host OS, as it is currently end-of-life (EOL) and no longer receiving security updates, which poses a significant risk to the overall security posture of the host.
